from django.core.management.base import BaseCommand
from django.utils import timezone
from datetime import timedelta
import random
from website.models import ApplicationForm


class Command(BaseCommand):
    help = '–°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞—è–≤–∫–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∫–∏'

    def add_arguments(self, parser):
        parser.add_argument(
            '--count',
            type=int,
            default=20,
            help='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—è–≤–æ–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20)'
        )

    def handle(self, *args, **options):
        count = options['count']
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        names = [
            '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á',
            '–ü–µ—Ç—Ä–æ–≤–∞ –ú–∞—Ä–∏—è –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞',
            '–°–∏–¥–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–µ–π –í–∏–∫—Ç–æ—Ä–æ–≤–∏—á',
            '–ö–æ–∑–ª–æ–≤–∞ –ï–ª–µ–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞',
            '–ú–æ—Ä–æ–∑–æ–≤ –î–º–∏—Ç—Ä–∏–π –ê–Ω–¥—Ä–µ–µ–≤–∏—á',
            '–ù–æ–≤–∏–∫–æ–≤–∞ –ê–Ω–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞',
            '–í–æ–ª–∫–æ–≤ –°–µ—Ä–≥–µ–π –ù–∏–∫–æ–ª–∞–µ–≤–∏—á',
            '–°–æ–∫–æ–ª–æ–≤–∞ –û–ª—å–≥–∞ –ò–≥–æ—Ä–µ–≤–Ω–∞',
            '–õ–µ–±–µ–¥–µ–≤ –ú–∏—Ö–∞–∏–ª –ü–µ—Ç—Ä–æ–≤–∏—á',
            '–ï–≥–æ—Ä–æ–≤–∞ –¢–∞—Ç—å—è–Ω–∞ –Æ—Ä—å–µ–≤–Ω–∞'
        ]
        
        phones = [
            '+7 (999) 123-45-67',
            '+7 (495) 987-65-43',
            '+7 (812) 555-12-34',
            '+7 (903) 777-88-99',
            '+7 (926) 444-55-66',
            '+7 (916) 111-22-33',
            '+7 (985) 666-77-88',
            '+7 (964) 333-44-55',
            '+7 (977) 999-00-11',
            '+7 (915) 222-33-44'
        ]
        
        messages = [
            '–ò–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Å–∞–π—Ç–∞. –ü—Ä–æ—Å—å–±–∞ —Å–≤—è–∑–∞—Ç—å—Å—è –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏.',
            '–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –º–æ–±–∏–ª—å–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –¥–ª—è iOS –∏ Android. –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è?',
            '–•–æ—Ç–∏–º –∑–∞–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –ö–∞–∫–∏–µ —É –≤–∞—Å –µ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è?',
            '–¢—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–∞–π—Ç–∞. –ú–æ–∂–µ—Ç–µ –ª–∏ –ø–æ–º–æ—á—å?',
            '–ü–ª–∞–Ω–∏—Ä—É–µ–º –∑–∞–ø—É—Å–∫ —Å—Ç–∞—Ä—Ç–∞–ø–∞, –Ω—É–∂–Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞. –û–±—Å—É–¥–∏–º —É—Å–ª–æ–≤–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞?',
            '–ò–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ CRM —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –Ω–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏. –ï—Å—Ç—å –ª–∏ —É –≤–∞—Å –æ–ø—ã—Ç –≤ —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏?',
            '–ù—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ Django. –°–∫–æ–ª—å–∫–æ —ç—Ç–æ –º–æ–∂–µ—Ç —Å—Ç–æ–∏—Ç—å?',
            '–•–æ—Ç–∏–º –∑–∞–∫–∞–∑–∞—Ç—å –ª–µ–Ω–¥–∏–Ω–≥ –¥–ª—è –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞. –ö–∞–∫–∏–µ —Å—Ä–æ–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è?',
            '–¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API. –ú–æ–∂–µ—Ç–µ –ª–∏ –≤–∑—è—Ç—å—Å—è –∑–∞ —Ç–∞–∫—É—é –∑–∞–¥–∞—á—É?',
            '–ü–ª–∞–Ω–∏—Ä—É–µ–º —Ä–µ–¥–∏–∑–∞–π–Ω —Å–∞–π—Ç–∞ –∏ —É–ª—É—á—à–µ–Ω–∏–µ UX. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç–µ –ª–∏ –≤—ã —Ç–∞–∫–∏–µ —É—Å–ª—É–≥–∏?'
        ]
        
        notes = [
            '–ö–ª–∏–µ–Ω—Ç –æ—á–µ–Ω—å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω, –Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –≤—Å—Ç—Ä–µ—á–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ',
            '–¢—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –≤–æ–ø—Ä–æ—Å–∞–º',
            '–ë—é–¥–∂–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω, –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ',
            '–°—Ä–æ—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç',
            '–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç, —Ö–æ—Ä–æ—à–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è',
            '–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç, –Ω—É–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Ö–æ—Ä–æ—à–µ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ',
            '–ü—Ä–æ–µ–∫—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–º',
            '–ö–ª–∏–µ–Ω—Ç —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π',
            '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è',
            '–ì–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è'
        ]
        
        created_count = 0
        
        for i in range(count):
            # –°–ª—É—á–∞–π–Ω–∞—è –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π)
            days_ago = random.randint(0, 30)
            created_date = timezone.now() - timedelta(days=days_ago)
            
            # –°–ª—É—á–∞–π–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã (–±–æ–ª—å—à–µ –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫)
            status_choice = random.choices(
                ['new', 'processed', 'contacted', 'completed'],
                weights=[50, 25, 15, 10]  # –ë–æ–ª—å—à–µ –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫
            )[0]
            
            if status_choice == 'new':
                is_processed = False
                is_contacted = False
            elif status_choice == 'processed':
                is_processed = True
                is_contacted = False
            elif status_choice == 'contacted':
                is_processed = False
                is_contacted = True
            else:  # completed
                is_processed = True
                is_contacted = True
            
            # –°–æ–∑–¥–∞–µ–º –∑–∞—è–≤–∫—É
            application = ApplicationForm.objects.create(
                full_name=random.choice(names),
                phone=random.choice(phones),
                message=random.choice(messages),
                is_processed=is_processed,
                is_contacted=is_contacted,
                notes=random.choice(notes) if random.random() > 0.3 else '',
                created_date=created_date
            )
            
            created_count += 1
            
            if created_count % 5 == 0:
                self.stdout.write(f'–°–æ–∑–¥–∞–Ω–æ {created_count} –∑–∞—è–≤–æ–∫...')
        
        self.stdout.write(
            self.style.SUCCESS(
                f'‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ {created_count} —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫!'
            )
        )
        
        # –í—ã–≤–æ–¥–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        total = ApplicationForm.objects.count()
        new = ApplicationForm.objects.filter(is_processed=False, is_contacted=False).count()
        processed = ApplicationForm.objects.filter(is_processed=True, is_contacted=False).count()
        contacted = ApplicationForm.objects.filter(is_processed=False, is_contacted=True).count()
        completed = ApplicationForm.objects.filter(is_processed=True, is_contacted=True).count()
        
        self.stdout.write('\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫:')
        self.stdout.write(f'  –í—Å–µ–≥–æ: {total}')
        self.stdout.write(f'  üÜï –ù–æ–≤—ã–µ: {new}')
        self.stdout.write(f'  üîÑ –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ: {processed}')
        self.stdout.write(f'  üìû –°–≤—è–∑–∞–ª–∏—Å—å: {contacted}')
        self.stdout.write(f'  ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ: {completed}')
        
        self.stdout.write(f'\nüîó –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω–∫—É: http://127.0.0.1:8000/admin/website/applicationform/')
